@page
@model DAB_NoSQL_assignment.ProfileModel

<h1>Profile</h1>

<div class="row">
    <div class="col-md-6">
        <form method="post">
            <h5>Create a new post or show posts from entered user</h5>
            <hr />
            <div asp-validation-summary="All" class="text-danger"></div>
            <div class="form-group">
                <!--Type owner of post here-->
                <label asp-for="postBoundProperty.PostOwner"> Owner of Posts</label>
                <input asp-for="postBoundProperty.PostOwner" class="form-control" />
            </div>
            <div class="form-group">
                <label asp-for="postBoundProperty.Text">Post Text</label>
                <input asp-for="postBoundProperty.Text" class="form-control" />
            </div>
            <div class="form-group">
                <label asp-for="postcircleBoundProperty">Post Circle</label>
                <input asp-for="postcircleBoundProperty" class="form-control" />
            </div>
            <hr />
            <button type="submit" class="btn btn-primary" asp-page-handler="Post">Create a Post</button>
            <button type="submit" class="btn btn-primary" asp-page-handler="ShowPosts">Show Posts</button>

            @if (Model.postList != null && Model.user != null)
            {

                @foreach (var post in @Model.postList)
                {
                    <table>
                        <tr>
                            <th>PostOwner</th>
                            <th>Text</th>
                        </tr>
                        <tr>
                            <td>@Model.user.Name</td>
                            <td>@post.Text</td>
                        </tr>
                        <tr>
                            <th>Comments:</th>
                            <th>
                                Add comment:
                                <br />
                                <label asp-for="commentBoundProperty.Writer_userName">Name of commentWriter</label>
                                <input asp-for="commentBoundProperty.Writer_userName" />
                                <br />
                                <label asp-for="commentBoundProperty.Text">Text</label>
                                <input asp-for="commentBoundProperty.Text" class="form-control" />
                                <input asp-for="commentBoundProperty.OwnerPostID" value="@post.Id" type="hidden" />
                                <button type="submit" class="btn btn-primary" asp-page-handler="AddComment">Add</button>

                            </th>
                        </tr>
                        @if (post.Comments != null)
                        {
                            @foreach (var comment in post.Comments)
                            {
                                <tr>
                                    <td>@comment.Text</td>
                                    <td>@comment.Writer_userName</td>
                                </tr>
                            }
                        }
                    </table>
                    <br />
                    <br />
                }


            }
        </form>
    </div>
</div>

